# vulnerability.py
from .utils import check_ssh_vulnerability, check_http_vulnerability, check_ftp_vulnerability, check_smtp_vulnerability

def scan_vulnerabilities(ip_address, open_ports):
    vulnerabilities = {}
    for port in open_ports:
        if port == 22:  # SSH
            vulnerabilities[port] = check_ssh_vulnerability(ip_address)
        elif port in [80, 443]:  # HTTP/HTTPS
            vulnerabilities[port] = check_http_vulnerability(ip_address, port)
        elif port == 21:  # FTP
            vulnerabilities[port] = check_ftp_vulnerability(ip_address)
        elif port == 25 or port == 587:  # SMTP
            vulnerabilities[port] = check_smtp_vulnerability(ip_address)
        # ... more checks for other ports ...

    return vulnerabilities
